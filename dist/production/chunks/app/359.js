(self.webpackChunkneo_mjs_realworld_example_app=self.webpackChunkneo_mjs_realworld_example_app||[]).push([[359],{9359:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>s});var n=o(5557);class l extends n.Z{static getConfig(){return{className:"RealWorld.view.article.CreateCommentComponent",cls:["card","comment-form"],userImage_:null,userName_:null,_vdom:{tag:"form",cn:[{cls:["card-block"],cn:[{tag:"textarea",cls:["form-control"],placeholder:"Write a comment...",rows:3}]},{cls:["card-footer"],cn:[{tag:"img",cls:["comment-author-img"],src:"https://static.productionready.io/images/smiley-cyrus.jpg"},{vtype:"text",html:"&nbsp;"},{tag:"span",cls:["comment-author"]},{tag:"button",cls:["btn","btn-sm","btn-primary"],html:"Post Comment",type:"button"}]}]}}}constructor(t){super(t);let e=this,o=e.domListeners,n=e.vdom;o.push({click:{fn:e.onSubmitButtonClick,delegate:".btn-primary",scope:e}}),e.domListeners=o,n.cn[0].cn[0].id=e.getInputElId(),e.vdom=n,e.getController().on({afterSetCurrentUser:e.onCurrentUserChange,scope:e})}afterSetUserImage(t,e){if(t){let e=this.vdom;e.cn[1].cn[0].src=t,this.vdom=e}}afterSetUserName(t,e){if(t){let e=this.vdom;e.cn[1].cn[2].html=t,this.vdom=e}}getInputElId(){return this.id+"__input"}onCurrentUserChange(t){this.set({userImage:t.image,userName:t.username})}onSubmitButtonClick(t){let e=this;Neo.main.DomAccess.getAttributes({id:e.getInputElId(),attributes:"value"}).then((t=>{e.getController().postComment({data:JSON.stringify({comment:{body:t.value}})}).then((t=>{let o=e.vdom;o.cn[0].cn[0].value="",e.vdom=o}))}))}}Neo.applyClassConfig(l);var a=o(2926),r=o(1939);class s extends n.Z{static getConfig(){return{className:"RealWorld.view.article.Component",author_:null,body_:null,commentComponent:null,commentComponents:[],comments_:null,createCommentComponent:null,createdAt_:null,cls:["article-page"],favorited_:!1,favoritesCount_:null,tagList_:null,title_:null,_vdom:{cn:[{cls:["banner"],cn:[{cls:["container"],cn:[{tag:"h1",flag:"title"},{cls:["article-meta"],cn:[{tag:"a",flag:"userimage",cn:[{tag:"img"}]},{cls:["info"],cn:[{tag:"a",cls:["author"],flag:"username"},{tag:"span",cls:["date"],flag:"createdAt"}]},{tag:"button",cls:["btn","btn-sm","btn-outline-secondary","follow-button"],cn:[{tag:"i",flag:"followIcon"},{vtype:"text",flag:"followAuthor"},{vtype:"text",flag:"username"}]},{tag:"button",cls:["btn","btn-sm","btn-outline-secondary","edit-button"],flag:"edit-button",removeDom:!0,cn:[{tag:"i",cls:["ion-edit"]},{vtype:"text",html:" Edit Article"}]},{vtype:"text",html:"&nbsp;&nbsp;"},{tag:"button",cls:["btn","btn-sm","btn-outline-primary","favorite-button"],flag:"favorited",cn:[{tag:"i",cls:["ion-heart"]},{vtype:"text",html:"&nbsp;"},{vtype:"text"},{vtype:"text",html:" Post "},{tag:"span",cls:["counter"],flag:"favoritesCount"}]},{tag:"button",cls:["btn","btn-sm","btn-outline-danger","delete-button"],flag:"delete-button",removeDom:!0,cn:[{tag:"i",cls:["ion-trash-a"]},{vtype:"text",html:" Delete Article"}]}]}]}]},{cls:["container","page"],cn:[{cls:["row","article-content"],cn:[{cls:["col-md-12"],flag:"body",cn:[]}]},{tag:"hr"},{cls:["article-actions"],flag:"article-actions",cn:[{cls:["article-meta"],cn:[{tag:"a",flag:"userimage",cn:[{tag:"img"}]},{cls:["info"],cn:[{tag:"a",cls:["author"],flag:"username"},{tag:"span",cls:["date"],html:"January 20th"}]},{tag:"button",cls:["btn","btn-sm","btn-outline-secondary","follow-button"],cn:[{tag:"i",flag:"followIcon"},{vtype:"text",flag:"followAuthor"},{vtype:"text",flag:"username"}]},{vtype:"text",html:"&nbsp;&nbsp;"},{tag:"button",cls:["btn","btn-sm","btn-outline-primary","favorite-button"],flag:"favorited",cn:[{tag:"i",cls:["ion-heart"]},{vtype:"text",html:"&nbsp;"},{vtype:"text"},{vtype:"text",html:" Post "},{tag:"span",cls:["counter"],flag:"favoritesCount"}]}]}]},{cls:"row",cn:[{cls:["col-xs-12","col-md-8","offset-md-2"],flag:"comments-section",cn:[]}]}]}]}}}constructor(t){super(t);let e=this,o=e.domListeners;o.push({click:{fn:e.onDeleteButtonClick,delegate:".delete-button",scope:e}},{click:{fn:e.onEditButtonClick,delegate:".edit-button",scope:e}},{click:{fn:e.onFavoriteButtonClick,delegate:".favorite-button",scope:e}},{click:{fn:e.onFollowButtonClick,delegate:".follow-button",scope:e}}),e.domListeners=o,e.getController().on({afterSetCurrentUser:e.onCurrentUserChange,scope:e})}onConstructed(){let t=this,e=t.getController().currentUser,o=t.vdom;t.createCommentComponent=Neo.create({module:l,parentId:t.id,userImage:e&&e.image||null}),r.Z.getByFlag(o,"comments-section").cn.unshift(t.createCommentComponent.vdom),t.vdom=o,super.onConstructed()}afterSetAuthor(t,e){if(t){let e=this,o=e.vdom;r.Z.getFlags(o,"followAuthor").forEach((e=>{e.html=t.following?" Unfollow ":" Follow "})),r.Z.getFlags(o,"followIcon").forEach((e=>{e.cls=t.following?["ion-minus-round"]:["ion-plus-round"]})),r.Z.getFlags(o,"userimage").forEach((e=>{e.href="#/profile/"+t.username,e.cn[0].src=t.image})),r.Z.getFlags(o,"username").forEach((e=>{e.href="#/profile/"+t.username,e.html=t.username})),e.vdom=o,e.onCurrentUserChange()}}afterSetBody(t,e){const o=this;t&&Neo.main.addon.Markdown.markdownToHtml(t).then((t=>{let e=o.vdom;r.Z.getByFlag(e,"body").cn[0]={cn:[{tag:"p",html:t}]},o.vdom=e}))}async afterSetComments(t,e){if(Array.isArray(t)){let e,n,l=this,a=l.vdom,s=r.Z.getByFlag(a,"comments-section");l.commentComponent||(n=await o.e(632).then(o.bind(o,9632)),l.commentComponent=n.default),s.cn=[s.cn.shift()],t.forEach(((t,o)=>{e={author:t.author,body:t.body,commentId:t.id,createdAt:t.createdAt,updatedAt:t.updatedAt},l.commentComponents[o]?l.commentComponents[o].set(e,!0):l.commentComponents[o]=Neo.create({module:l.commentComponent,parentId:l.id,...e}),s.cn.push(l.commentComponents[o].vdom)})),l.vdom=a}}afterSetCreatedAt(t,e){if(t){let e=this.vdom;r.Z.getByFlag(e,"createdAt").html=new Intl.DateTimeFormat("en-US",{day:"numeric",month:"long",year:"numeric"}).format(new Date(t)),this.vdom=e}}afterSetFavorited(t,e){let o=this,n=o.vdom;r.Z.getFlags(n,"favorited").forEach((e=>{e.cn[2].html=t?"Unfavorite":"Favorite",a.Z.add(e.cls,t?"btn-primary":"btn-outline-primary"),a.Z.remove(e.cls,t?"btn-outline-primary":"btn-primary")})),o.vdom=n,Neo.isBoolean(e)&&o.getController().favoriteArticle(o.slug,t).then((t=>{o.favoritesCount=t.json.article.favoritesCount}))}afterSetFavoritesCount(t,e){if(Neo.isNumber(t)){let e=this.vdom;r.Z.getFlags(e,"favoritesCount").forEach((e=>{e.html=`(${t})`})),this.vdom=e}}afterSetTagList(t,e){let o,n=this.vdom,l=r.Z.getByFlag(n,"body");Array.isArray(t)&&t.length>0?(o={tag:"ul",cls:["tag-list"],cn:[]},t.forEach((t=>{o.cn.push({tag:"li",cls:["tag-default","tag-pill","tag-outline"],html:t})})),l.cn[1]=o):l.cn[1]&&(l.cn[1].removeDom=!0),this.vdom=n}afterSetTitle(t,e){let o=this.vdom;r.Z.getByFlag(o,"title").html=t,this.vdom=o}onCurrentUserChange(){console.log("### onCurrentUserChange");let t,e=this,o=e.getController().currentUser,n=e.vdom;e.author&&o&&(t=e.author.username===o.username,n.cn[0].cn[0].cn[1].cn[2].removeDom=t,n.cn[0].cn[0].cn[1].cn[5].removeDom=t,r.Z.getByFlag(n,"article-actions").removeDom=t,r.Z.getByFlag(n,"delete-button").removeDom=!t,r.Z.getByFlag(n,"edit-button").removeDom=!t,e.vdom=n)}onDeleteButtonClick(t){this.getController().deleteArticle(this.slug)}onEditButtonClick(t){Neo.Main.setRoute({value:"/editor/"+this.slug})}onFavoriteButtonClick(t){this.favorited=!this.favorited}onFollowButtonClick(t){let e=this;e.getController().followUser(e.author.username,!e.author.following).then((t=>{e.author=t.json.profile}))}}Neo.applyClassConfig(s)}}]);